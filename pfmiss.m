function nmiss = pfmiss(Y,vbus,s_net_demand)%%  This routine forms the vector of complex power mismatch%  at each bus.%  %  Arguments: complex bus admittance matrix, Y;%             vector of complex bus voltage phasors, vbus;%             vector of complex bus power demand (net), %             s_net_demand; (note that s_net_demand will be%             negative at buses generating power)%%  Returns:   a full complex n-vector of power mismatch.%               Sign convention - power LEAVING the bus%               is signed positive; that entering the bus%               is signed negative.%  Comments:  Note that we return ALL mismatches%             of power at EVERY bus.  %%             Slack, P-V, and P-Q bus models are not%             imposed at this point.%%j=sqrt(-1);%ibus=Y*vbus;nmiss = vbus.*conj(ibus)+s_net_demand;